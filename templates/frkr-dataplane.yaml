apiVersion: frkr.io/v1
kind: FrkrDataPlane
metadata:
  name: frkr-dataplane
  namespace: {{ .Release.Namespace }}
spec:
  postgresConfig:
    host: {{ .Values.dataPlane.db.host | quote }}
    port: {{ .Values.dataPlane.db.port }}
    database: {{ .Values.dataPlane.db.database | quote }}
    user: {{ .Values.dataPlane.db.user | quote }}
    type: {{ .Values.dataPlane.db.type | default "postgres" | quote }}
    passwordRef: "frkr-db-secret"
    sslMode: {{ .Values.dataPlane.db.sslMode | quote }}
  brokerConfig:
    brokers:
    {{- range .Values.dataPlane.broker.brokers }}
      - {{ . }}
    {{- end }}
    {{- if .Values.dataPlane.broker.tlsEnabled }}
    tlsEnabled: true
    tlsConfigRef: {{ .Values.dataPlane.broker.tlsConfigRef }}
    {{- end }}
